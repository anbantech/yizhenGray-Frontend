import { getCanvas, newSetDataHander, newSetPeripheral, newSetRegister, newSetTimer, saveCanvasAsync } from 'Src/services/api/modelApi'
import { throwErrorMessage } from 'Src/util/message'
import crc32 from 'crc-32'
// import pako from 'pako'

import {
  Connection,
  Edge,
  EdgeChange,
  Node,
  NodeChange,
  addEdge,
  OnNodesChange,
  OnEdgesChange,
  OnConnect,
  applyNodeChanges,
  applyEdgeChanges
} from 'reactflow'

import { create } from 'zustand'
import { AttributesType, NodeType, NodeZindex } from '../MapStore'

const pako = require('pako')

type RFState = {
  platform_id: null | string
  nodes: any
  edges: any
  menuStatusObj: { status: boolean; id: null | string }
  nodeId: null | number | string
  changeView: boolean
  canvasData: any
  onNodesChange: OnNodesChange
  onEdgesChange: OnEdgesChange
  onConnect: OnConnect
  setChangeView: (val: boolean) => void
  setMenuStatus: (id: string) => void
  setOpenMenu: () => void
  getModelDetails: (id: number) => any
  setNodes: (nodesValue: any) => void
  setEdges: (edgesValue: Edge[]) => void
  getSumNodeId: (nodeArray: Node[]) => string
  setNodeId: (val: string | number | null) => void
  upDateNodesAndEdges: (newNode: Node[], newEdge: Edge[]) => void
  expandNode: (nodeId: string) => void
  addChildNode: (Node: NodeProps, parentId: string) => void
  getChildernNums: (id: string) => number
  createPeripheral: (
    params: any,
    fn: (val: number, tabs: string) => void,
    id: number,
    cancel: () => void,
    tabs: string,
    fn2: (val: string, id: string) => void
  ) => void
  createRegister: (
    params: any,
    fn: (val: number, tabs: string) => void,
    id: number,
    cancel: () => void,
    tabs: string,
    fn2: (val: string, id: string) => void
  ) => void
  createDataHandler: (
    params: any,
    fn: (val: number, tabs: string) => void,
    id: number,
    cancel: () => void,
    tabs: string,
    fn2: (val: string, id: string) => void
  ) => void
  createTimer: (
    params: any,
    fn: (val: number, tabs: string) => void,
    id: number,
    cancel: () => void,
    tabs: string,
    fn2: (val: string, id: string) => void
  ) => void
  createElement: (
    tabs: string,
    params: any,
    fn: (val: number, tabs: string) => void,
    id: number,
    cancel: () => void,
    fn2: (val: string, id: string) => void
  ) => void
  initTreeToNodeAndToEedg: (initData: any) => void
  zindexNode: (nodeId: string, zIndex: number) => void
  nodeTemplate: (node: NodeProps, parentId: string) => any
  edgeTemplate: (node: NodeProps, source: string, target: string) => any
  saveCanvas: (nodes: any[], edges: Edge[], id: string) => void
  clearNodeAndEdge: () => void
  updateNodeName: (id: string, typeAndValue?: Record<string, any>) => void
  saveCanvasAndUpdateNodeName: (id: string, typeAndValue?: Record<string, any>) => void
}

type NodeProps = {
  name: string
  id: string
  flag: 0 | 1 | 2 | 3 | 4 | 5
  children?: NodeProps[]
}
//  1. 外设 2. 寄存器 3.数据处理器 4.定时器，5 建模任务
const MiddleStore = create<RFState>((set, get) => ({
  platform_id: null,
  nodes: [],
  edges: [],
  canvasData: [],
  menuStatusObj: { status: false, id: null },
  nodeId: null,
  changeView: false,
  setMenuStatus: (id: string) => {
    set({ menuStatusObj: { status: !get().menuStatusObj.status, id } })
  },
  setOpenMenu: () => {
    set({ menuStatusObj: { status: false, id: null } })
  },

  setChangeView: val => {
    set({ changeView: val })
  },
  // 获取节点ID生成checkSum
  getSumNodeId: nodeArray => {
    if (nodeArray.length === 0) return '0'
    const idArray = nodeArray.map((item: { id: string }) => item.id).join(',')
    // eslint-disable-next-line no-bitwise
    const crc32Value = crc32.str(idArray) >>> 0
    const hex = crc32Value.toString(16).toUpperCase()
    return hex
  },
  // 节点模版
  nodeTemplate: (node: NodeProps, parentId: string) => {
    const newNode = {
      data: {
        label: `${node.name}`,
        id: String(node.id),
        expanded: false,
        position: { x: 0, y: 0 },
        draggable: false,
        flag: node.flag,
        zIndex: NodeZindex[node.flag as keyof typeof NodeZindex],
        parentId: String(parentId)
      },
      type: 'peripheralNode',
      id: String(node.id),
      position: { x: 0, y: 0 },
      draggable: false
    }
    return newNode
  },
  // 边模版
  edgeTemplate: (node: NodeProps, source: string, target: string) => {
    return {
      flag: node.flag,
      id: `${source}->${target}`,
      source,
      target,
      type: 'step',
      data: {
        label: 'edge label'
      }
    }
  },

  setNodeId: val => {
    set({ nodeId: val })
  },

  setNodes: nodesValue => {
    set({ nodes: nodesValue })
  },

  getChildernNums: (id: string) => {
    const res = get().nodes.filter((item: { data: { parentId: string } }) => {
      return item.data.parentId === id
    })
    return res.length
  },

  setEdges: (edgesValue: Edge[]) => {
    set({
      edges: edgesValue
    })
  },

  upDateNodesAndEdges: (newNode, newEdge) => {
    set({
      nodes: newNode,
      edges: newEdge
    })
  },

  expandNode: (nodeId: string) => {
    set({
      nodes: get().nodes.map((node: Node) => {
        if (node.id === nodeId) {
          // it's important to create a new object here, to inform React Flow about the changes
          return { ...node, data: { ...node.data, expanded: !node.data.expanded } }
        }
        return node
      })
    })
  },

  zindexNode: (nodeId: string, zIndex) => {
    set({
      nodes: get().nodes.map((node: Node) => {
        if (node.id === nodeId) {
          // it's important to create a new object here, to inform React Flow about the changes
          return { ...node, style: { ...node.style, zIndex } }
        }
        return node
      })
    })
  },

  addChildNode: (node: NodeProps, parentId: string) => {
    const { saveCanvas, platform_id } = get()
    const newNode = {
      data: {
        label: node.name,
        id: String(node.id),
        expanded: true,
        position: { x: 0, y: 0 },
        draggable: false,
        flag: node.flag,
        zIndex: NodeZindex[node.flag as keyof typeof NodeZindex],
        parentId: String(parentId)
      },
      type: 'peripheralNode',
      id: String(node.id),
      position: { x: 0, y: 0 },
      draggable: false
    }
    const newEdge = {
      id: `${String(parentId)}->${String(node.id)}`,
      type: 'step',
      data: { label: '12' },
      source: String(parentId),
      target: String(node.id)
    }
    const nodesOBJ = [...get().nodes, newNode]
    const edgesOBJ = [...get().edges, newEdge]
    saveCanvas(nodesOBJ, edgesOBJ, platform_id as string)
    set({
      nodes: [...get().nodes, newNode],
      edges: [...get().edges, newEdge]
    })
  },

  onNodesChange: (changes: NodeChange[]) => {
    const { nodes } = get()
    set({
      nodes: applyNodeChanges(changes, nodes)
    })
  },

  onEdgesChange: (changes: EdgeChange[]) => {
    set({
      edges: applyEdgeChanges(changes, get().edges)
    })
  },

  onConnect: (connection: Connection) => {
    set({
      edges: addEdge(connection, get().edges)
    })
  },
  // 创建目标机时初始化节点和边
  initTreeToNodeAndToEedg: initData => {
    const { saveCanvas } = get()

    const converTreeToNode = (node: NodeProps, parentId: string) => {
      const result = []
      result.push({
        data: {
          label: `${node.name}`,
          id: node.id,
          parentId,
          expanded: false,
          position: { x: 0, y: 0 },
          draggable: false,
          flag: node.flag
        },
        type: NodeType[node.flag as keyof typeof NodeType],
        id: node.id,
        position: { x: 0, y: 0 },
        draggable: false,
        zIndex: NodeZindex[node.flag as keyof typeof NodeZindex]
      })
      if (node.children && node.children.length > 0) {
        node.children.forEach((item: any) => {
          result.push(...converTreeToNode(item, node.id))
        })
      }
      return result
    }
    const nodeArray = converTreeToNode(initData, initData.id)
    const converTreeToEdges = (node: any) => {
      const links: any[] = []
      if (node.children && node.children.length > 0) {
        node.children.forEach((item: any) => {
          const source = node.id
          const target = item.id
          links.push({
            flag: node.flag,
            id: `${source}->${target}`,
            source,
            target,
            type: 'step',
            data: {
              label: 'edge label'
            }
          })
          links.push(...converTreeToEdges(item))
        })
      }
      return links
    }

    const edgeArray = converTreeToEdges(initData)
    saveCanvas(nodeArray, edgeArray, initData.id)
  },
  // 保存画布
  saveCanvas: async (nodes, edges, id) => {
    const { getSumNodeId } = get()
    // 计算校验和
    const sumId = getSumNodeId(nodes)
    console.log(nodes)
    // 使用pako进行压缩
    const jsonString = JSON.stringify({
      nodes: [...nodes],
      edges: [...edges]
    })
    const compressed = pako.deflate(jsonString, { to: 'string' })
    const compressedStringfy = JSON.stringify(compressed)
    const params = {
      id,
      checksum: sumId,
      canvas: compressedStringfy
    }
    try {
      const res = await saveCanvasAsync(params)
    } catch (error) {
      throwErrorMessage(error)
    }
  },

  // 初始化获取画布数据
  getModelDetails: async id => {
    if (!id) return
    console.log('22')
    set({ platform_id: String(id) })
    try {
      const res = await getCanvas(id)
      const decompressed = pako.inflate(res.data.canvas, { to: 'string' })
      const data = pako.inflate(
        {
          '0': 120,
          '1': 156,
          '2': 205,
          '3': 157,
          '4': 91,
          '5': 111,
          '6': 219,
          '7': 198,
          '8': 22,
          '9': 70,
          '10': 255,
          '11': 74,
          '12': 193,
          '13': 103,
          '14': 23,
          '15': 16,
          '16': 175,
          '17': 154,
          '18': 241,
          '19': 67,
          '20': 1,
          '21': 71,
          '22': 82,
          '23': 21,
          '24': 1,
          '25': 178,
          '26': 163,
          '27': 91,
          '28': 18,
          '29': 3,
          '30': 7,
          '31': 69,
          '32': 161,
          '33': 202,
          '34': 172,
          '35': 173,
          '36': 3,
          '37': 31,
          '38': 219,
          '39': 149,
          '40': 149,
          '41': 54,
          '42': 105,
          '43': 224,
          '44': 255,
          '45': 126,
          '46': 70,
          '47': 28,
          '48': 218,
          '49': 218,
          '50': 51,
          '51': 35,
          '52': 239,
          '53': 38,
          '54': 220,
          '55': 91,
          '56': 221,
          '57': 124,
          '58': 9,
          '59': 34,
          '60': 200,
          '61': 152,
          '62': 143,
          '63': 139,
          '64': 35,
          '65': 126,
          '66': 90,
          '67': 188,
          '68': 136,
          '69': 252,
          '70': 26,
          '71': 221,
          '72': 221,
          '73': 95,
          '74': 149,
          '75': 143,
          '76': 209,
          '77': 233,
          '78': 127,
          '79': 190,
          '80': 70,
          '81': 87,
          '82': 203,
          '83': 237,
          '84': 50,
          '85': 58,
          '86': 253,
          '87': 26,
          '88': 221,
          '89': 46,
          '90': 127,
          '91': 43,
          '92': 111,
          '93': 163,
          '94': 211,
          '95': 232,
          '96': 238,
          '97': 243,
          '98': 93,
          '99': 116,
          '100': 18,
          '101': 173,
          '102': 175,
          '103': 204,
          '104': 127,
          '105': 85,
          '106': 199,
          '107': 252,
          '108': 239,
          '109': 97,
          '110': 185,
          '111': 41,
          '112': 239,
          '113': 182,
          '114': 163,
          '115': 151,
          '116': 215,
          '117': 229,
          '118': 231,
          '119': 135,
          '120': 229,
          '121': 221,
          '122': 85,
          '123': 105,
          '124': 94,
          '125': 255,
          '126': 190,
          '127': 188,
          '128': 125,
          '129': 44,
          '130': 205,
          '131': 31,
          '132': 220,
          '133': 63,
          '134': 174,
          '135': 183,
          '136': 235,
          '137': 251,
          '138': 187,
          '139': 221,
          '140': 32,
          '141': 159,
          '142': 163,
          '143': 211,
          '144': 206,
          '145': 73,
          '146': 244,
          '147': 197,
          '148': 252,
          '149': 251,
          '150': 116,
          '151': 18,
          '152': 93,
          '153': 109,
          '154': 150,
          '155': 215,
          '156': 215,
          '157': 203,
          '158': 223,
          '159': 110,
          '160': 203,
          '161': 151,
          '162': 63,
          '163': 253,
          '164': 253,
          '165': 118,
          '166': 121,
          '167': 29,
          '168': 157,
          '169': 230,
          '170': 207,
          '171': 131,
          '172': 216,
          '173': 247,
          '174': 182,
          '175': 155,
          '176': 79,
          '177': 165,
          '178': 249,
          '179': 235,
          '180': 237,
          '181': 151,
          '182': 7,
          '183': 243,
          '184': 34,
          '185': 218,
          '186': 46,
          '187': 55,
          '188': 215,
          '189': 229,
          '190': 246,
          '191': 194,
          '192': 44,
          '193': 158,
          '194': 187,
          '195': 20,
          '196': 223,
          '197': 30,
          '198': 242,
          '199': 247,
          '200': 200,
          '201': 44,
          '202': 158,
          '203': 249,
          '204': 155,
          '205': 184,
          '206': 211,
          '207': 73,
          '208': 79,
          '209': 162,
          '210': 191,
          '211': 214,
          '212': 87,
          '213': 219,
          '214': 27,
          '215': 243,
          '216': 34,
          '217': 53,
          '218': 169,
          '219': 55,
          '220': 229,
          '221': 250,
          '222': 250,
          '223': 102,
          '224': 27,
          '225': 157,
          '226': 102,
          '227': 234,
          '228': 233,
          '229': 36,
          '230': 4,
          '231': 31,
          '232': 156,
          '233': 143,
          '234': 126,
          '235': 126,
          '236': 206,
          '237': 212,
          '238': 121,
          '239': 247,
          '240': 40,
          '241': 232,
          '242': 49,
          '243': 134,
          '244': 254,
          '245': 80,
          '246': 110,
          '247': 214,
          '248': 15,
          '249': 55,
          '250': 229,
          '251': 102,
          '252': 121,
          '253': 11,
          '254': 241,
          '255': 235,
          '256': 69,
          '257': 105,
          '258': 196,
          '259': 159,
          '260': 28,
          '261': 226,
          '262': 28,
          '263': 190,
          '264': 25,
          '265': 247,
          '266': 22,
          '267': 227,
          '268': 231,
          '269': 225,
          '270': 139,
          '271': 78,
          '272': 145,
          '273': 184,
          '274': 168,
          '275': 54,
          '276': 144,
          '277': 206,
          '278': 154,
          '279': 184,
          '280': 172,
          '281': 213,
          '282': 123,
          '283': 123,
          '284': 216,
          '285': 77,
          '286': 121,
          '287': 189,
          '288': 126,
          '289': 220,
          '290': 150,
          '291': 27,
          '292': 136,
          '293': 250,
          '294': 188,
          '295': 44,
          '296': 141,
          '297': 88,
          '298': 227,
          '299': 67,
          '300': 172,
          '301': 189,
          '302': 129,
          '303': 65,
          '304': 141,
          '305': 193,
          '306': 248,
          '307': 105,
          '308': 139,
          '309': 88,
          '310': 211,
          '311': 35,
          '312': 176,
          '313': 118,
          '314': 192,
          '315': 248,
          '316': 89,
          '317': 139,
          '318': 88,
          '319': 179,
          '320': 35,
          '321': 176,
          '322': 38,
          '323': 96,
          '324': 252,
          '325': 188,
          '326': 69,
          '327': 172,
          '328': 249,
          '329': 17,
          '330': 88,
          '331': 83,
          '332': 48,
          '333': 126,
          '334': 209,
          '335': 34,
          '336': 214,
          '337': 130,
          '338': 151,
          '339': 117,
          '340': 222,
          '341': 119,
          '342': 171,
          '343': 169,
          '344': 219,
          '345': 34,
          '346': 212,
          '347': 230,
          '348': 53,
          '349': 252,
          '350': 10,
          '351': 234,
          '352': 98,
          '353': 116,
          '354': 14,
          '355': 134,
          '356': 87,
          '357': 45,
          '358': 66,
          '359': 85,
          '360': 220,
          '361': 168,
          '362': 131,
          '363': 203,
          '364': 5,
          '365': 24,
          '366': 94,
          '367': 183,
          '368': 8,
          '369': 85,
          '370': 243,
          '371': 162,
          '372': 142,
          '373': 147,
          '374': 222,
          '375': 114,
          '376': 117,
          '377': 3,
          '378': 190,
          '379': 188,
          '380': 189,
          '381': 105,
          '382': 149,
          '383': 244,
          '384': 136,
          '385': 230,
          '386': 179,
          '387': 122,
          '388': 208,
          '389': 35,
          '390': 122,
          '391': 189,
          '392': 159,
          '393': 135,
          '394': 251,
          '395': 21,
          '396': 217,
          '397': 237,
          '398': 248,
          '399': 147,
          '400': 170,
          '401': 196,
          '402': 38,
          '403': 181,
          '404': 219,
          '405': 220,
          '406': 24,
          '407': 95,
          '408': 153,
          '409': 212,
          '410': 143,
          '411': 111,
          '412': 206,
          '413': 102,
          '414': 96,
          '415': 252,
          '416': 184,
          '417': 69,
          '418': 172,
          '419': 49,
          '420': 59,
          '421': 235,
          '422': 199,
          '423': 30,
          '424': 24,
          '425': 62,
          '426': 144,
          '427': 67,
          '428': 65,
          '429': 84,
          '430': 102,
          '431': 57,
          '432': 52,
          '433': 168,
          '434': 35,
          '435': 119,
          '436': 94,
          '437': 3,
          '438': 59,
          '439': 20,
          '440': 132,
          '441': 101,
          '442': 182,
          '443': 195,
          '444': 29,
          '445': 172,
          '446': 51,
          '447': 177,
          '448': 129,
          '449': 29,
          '450': 10,
          '451': 178,
          '452': 50,
          '453': 219,
          '454': 225,
          '455': 56,
          '456': 158,
          '457': 120,
          '458': 19,
          '459': 27,
          '460': 232,
          '461': 161,
          '462': 32,
          '463': 44,
          '464': 179,
          '465': 30,
          '466': 238,
          '467': 96,
          '468': 157,
          '469': 137,
          '470': 13,
          '471': 244,
          '472': 80,
          '473': 144,
          '474': 149,
          '475': 89,
          '476': 15,
          '477': 199,
          '478': 113,
          '479': 223,
          '480': 223,
          '481': 100,
          '482': 3,
          '483': 67,
          '484': 20,
          '485': 164,
          '486': 101,
          '487': 54,
          '488': 196,
          '489': 138,
          '490': 214,
          '491': 153,
          '492': 218,
          '493': 192,
          '494': 17,
          '495': 5,
          '496': 97,
          '497': 153,
          '498': 29,
          '499': 113,
          '500': 247,
          '501': 29,
          '502': 11,
          '503': 70,
          '504': 15,
          '505': 20,
          '506': 81,
          '507': 144,
          '508': 148,
          '509': 93,
          '510': 17,
          '511': 63,
          '512': 190,
          '513': 25,
          '514': 93,
          '515': 124,
          '516': 216,
          '517': 7,
          '518': 248,
          '519': 135,
          '520': 217,
          '521': 36,
          '522': 97,
          '523': 9,
          '524': 7,
          '525': 219,
          '526': 14,
          '527': 194,
          '528': 158,
          '529': 159,
          '530': 205,
          '531': 192,
          '532': 33,
          '533': 9,
          '534': 213,
          '535': 34,
          '536': 113,
          '537': 82,
          '538': 204,
          '539': 226,
          '540': 100,
          '541': 72,
          '542': 193,
          '543': 129,
          '544': 38,
          '545': 213,
          '546': 34,
          '547': 111,
          '548': 82,
          '549': 204,
          '550': 222,
          '551': 100,
          '552': 72,
          '553': 193,
          '554': 161,
          '555': 23,
          '556': 213,
          '557': 34,
          '558': 105,
          '559': 82,
          '560': 204,
          '561': 210,
          '562': 100,
          '563': 72,
          '564': 193,
          '565': 129,
          '566': 23,
          '567': 213,
          '568': 34,
          '569': 101,
          '570': 82,
          '571': 204,
          '572': 202,
          '573': 100,
          '574': 72,
          '575': 51,
          '576': 48,
          '577': 122,
          '578': 139,
          '579': 124,
          '580': 73,
          '581': 49,
          '582': 251,
          '583': 146,
          '584': 33,
          '585': 205,
          '586': 193,
          '587': 232,
          '588': 45,
          '589': 178,
          '590': 37,
          '591': 197,
          '592': 108,
          '593': 75,
          '594': 134,
          '595': 180,
          '596': 0,
          '597': 163,
          '598': 183,
          '599': 200,
          '600': 148,
          '601': 20,
          '602': 179,
          '603': 41,
          '604': 25,
          '605': 210,
          '606': 46,
          '607': 24,
          '608': 189,
          '609': 69,
          '610': 154,
          '611': 164,
          '612': 152,
          '613': 53,
          '614': 201,
          '615': 144,
          '616': 42,
          '617': 48,
          '618': 122,
          '619': 139,
          '620': 52,
          '621': 73,
          '622': 49,
          '623': 107,
          '624': 146,
          '625': 33,
          '626': 213,
          '627': 251,
          '628': 209,
          '629': 117,
          '630': 139,
          '631': 28,
          '632': 73,
          '633': 243,
          '634': 59,
          '635': 82,
          '636': 12,
          '637': 36,
          '638': 73,
          '639': 183,
          '640': 72,
          '641': 146,
          '642': 244,
          '643': 17,
          '644': 36,
          '645': 9,
          '646': 88,
          '647': 146,
          '648': 110,
          '649': 145,
          '650': 37,
          '651': 105,
          '652': 126,
          '653': 75,
          '654': 138,
          '655': 129,
          '656': 38,
          '657': 233,
          '658': 22,
          '659': 105,
          '660': 146,
          '661': 230,
          '662': 215,
          '663': 164,
          '664': 24,
          '665': 120,
          '666': 146,
          '667': 110,
          '668': 145,
          '669': 39,
          '670': 105,
          '671': 126,
          '672': 79,
          '673': 138,
          '674': 129,
          '675': 40,
          '676': 233,
          '677': 22,
          '678': 137,
          '679': 146,
          '680': 230,
          '681': 23,
          '682': 165,
          '683': 24,
          '684': 152,
          '685': 146,
          '686': 110,
          '687': 145,
          '688': 41,
          '689': 105,
          '690': 102,
          '691': 83,
          '692': 26,
          '693': 221,
          '694': 153,
          '695': 136,
          '696': 205,
          '697': 167,
          '698': 135,
          '699': 237,
          '700': 188,
          '701': 188,
          '702': 45,
          '703': 87,
          '704': 219,
          '705': 251,
          '706': 205,
          '707': 115,
          '708': 148,
          '709': 206,
          '710': 189,
          '711': 111,
          '712': 88,
          '713': 201,
          '714': 243,
          '715': 55,
          '716': 205,
          '717': 191,
          '718': 96,
          '719': 15,
          '720': 158,
          '721': 191,
          '722': 57,
          '723': 127,
          '724': 127,
          '725': 249,
          '726': 22,
          '727': 172,
          '728': 210,
          '729': 64,
          '730': 15,
          '731': 181,
          '732': 220,
          '733': 244,
          '734': 114,
          '735': 235,
          '736': 225,
          '737': 251,
          '738': 75,
          '739': 112,
          '740': 82,
          '741': 89,
          '742': 7,
          '743': 122,
          '744': 40,
          '745': 72,
          '746': 202,
          '747': 172,
          '748': 135,
          '749': 131,
          '750': 203,
          '751': 197,
          '752': 228,
          '753': 29,
          '754': 100,
          '755': 13,
          '756': 4,
          '757': 81,
          '758': 144,
          '759': 149,
          '760': 89,
          '761': 16,
          '762': 251,
          '763': 229,
          '764': 159,
          '765': 235,
          '766': 213,
          '767': 126,
          '768': 243,
          '769': 40,
          '770': 142,
          '771': 115,
          '772': 177,
          '773': 90,
          '774': 147,
          '775': 45,
          '776': 181,
          '777': 104,
          '778': 46,
          '779': 136,
          '780': 7,
          '781': 183,
          '782': 212,
          '783': 254,
          '784': 224,
          '785': 3,
          '786': 60,
          '787': 215,
          '788': 106,
          '789': 254,
          '790': 204,
          '791': 155,
          '792': 213,
          '793': 130,
          '794': 135,
          '795': 181,
          '796': 193,
          '797': 172,
          '798': 214,
          '799': 203,
          '800': 194,
          '801': 248,
          '802': 9,
          '803': 238,
          '804': 159,
          '805': 159,
          '806': 253,
          '807': 58,
          '808': 57,
          '809': 155,
          '810': 157,
          '811': 157,
          '812': 15,
          '813': 22,
          '814': 131,
          '815': 217,
          '816': 126,
          '817': 149,
          '818': 198,
          '819': 255,
          '820': 198,
          '821': 236,
          '822': 122,
          '823': 196,
          '824': 175,
          '825': 77,
          '826': 111,
          '827': 115,
          '828': 41,
          '829': 62,
          '830': 56,
          '831': 189,
          '832': 59,
          '833': 228,
          '834': 253,
          '835': 224,
          '836': 73,
          '837': 123,
          '838': 62,
          '839': 198,
          '840': 205,
          '841': 141,
          '842': 248,
          '843': 48,
          '844': 231,
          '845': 124,
          '846': 0,
          '847': 174,
          '848': 79,
          '849': 139,
          '850': 59,
          '851': 254,
          '852': 126,
          '853': 78,
          '854': 149,
          '855': 39,
          '856': 244,
          '857': 41,
          '858': 102,
          '859': 222,
          '860': 207,
          '861': 217,
          '862': 161,
          '863': 198,
          '864': 96,
          '865': 120,
          '866': 127,
          '867': 63,
          '868': 71,
          '869': 18,
          '870': 149,
          '871': 121,
          '872': 63,
          '873': 103,
          '874': 135,
          '875': 154,
          '876': 130,
          '877': 225,
          '878': 253,
          '879': 253,
          '880': 28,
          '881': 73,
          '882': 84,
          '883': 230,
          '884': 253,
          '885': 156,
          '886': 201,
          '887': 116,
          '888': 62,
          '889': 3,
          '890': 163,
          '891': 251,
          '892': 187,
          '893': 57,
          '894': 146,
          '895': 164,
          '896': 220,
          '897': 215,
          '898': 87,
          '899': 142,
          '900': 38,
          '901': 144,
          '902': 212,
          '903': 223,
          '904': 203,
          '905': 145,
          '906': 36,
          '907': 229,
          '908': 190,
          '909': 186,
          '910': 114,
          '911': 52,
          '912': 128,
          '913': 164,
          '914': 254,
          '915': 78,
          '916': 142,
          '917': 36,
          '918': 41,
          '919': 243,
          '920': 78,
          '921': 78,
          '922': 175,
          '923': 231,
          '924': 144,
          '925': 250,
          '926': 190,
          '927': 47,
          '928': 73,
          '929': 202,
          '930': 236,
          '931': 251,
          '932': 14,
          '933': 167,
          '934': 111,
          '935': 251,
          '936': 146,
          '937': 156,
          '938': 220,
          '939': 182,
          '940': 239,
          '941': 128,
          '942': 250,
          '943': 170,
          '944': 47,
          '945': 9,
          '946': 202,
          '947': 172,
          '948': 250,
          '949': 131,
          '950': 30,
          '951': 0,
          '952': 141,
          '953': 3,
          '954': 251,
          '955': 149,
          '956': 3,
          '957': 141,
          '958': 185,
          '959': 237,
          '960': 23,
          '961': 126,
          '962': 193,
          '963': 196,
          '964': 45,
          '965': 18,
          '966': 164,
          '967': 152,
          '968': 89,
          '969': 144,
          '970': 166,
          '971': 142,
          '972': 243,
          '973': 122,
          '974': 206,
          '975': 32,
          '976': 233,
          '977': 188,
          '978': 205,
          '979': 149,
          '980': 225,
          '981': 160,
          '982': 243,
          '983': 78,
          '984': 223,
          '985': 77,
          '986': 22,
          '987': 96,
          '988': 45,
          '989': 6,
          '990': 30,
          '991': 152,
          '992': 202,
          '993': 205,
          '994': 40,
          '995': 179,
          '996': 7,
          '997': 26,
          '998': 55,
          '999': 234,
          '1000': 129,
          '1001': 209,
          '1002': 3,
          '1003': 13,
          '1004': 20,
          '1005': 36,
          '1006': 101,
          '1007': 214,
          '1008': 192,
          '1009': 105,
          '1010': 239,
          '1011': 2,
          '1012': 206,
          '1013': 105,
          '1014': 160,
          '1015': 129,
          '1016': 130,
          '1017': 164,
          '1018': 204,
          '1019': 26,
          '1020': 56,
          '1021': 237,
          '1022': 207,
          '1023': 33,
          '1024': 105,
          '1025': 160,
          '1026': 129,
          '1027': 130,
          '1028': 164,
          '1029': 204,
          '1030': 26,
          '1031': 56,
          '1032': 29,
          '1033': 245,
          '1034': 47,
          '1035': 193,
          '1036': 232,
          '1037': 129,
          '1038': 6,
          '1039': 10,
          '1040': 146,
          '1041': 50,
          '1042': 107,
          '1043': 224,
          '1044': 116,
          '1045': 238,
          '1046': 86,
          '1047': 82,
          '1048': 224,
          '1049': 129,
          '1050': 130,
          '1051': 168,
          '1052': 204,
          '1053': 30,
          '1054': 56,
          '1055': 157,
          '1056': 187,
          '1057': 157,
          '1058': 20,
          '1059': 168,
          '1060': 160,
          '1061': 32,
          '1062': 42,
          '1063': 179,
          '1064': 10,
          '1065': 78,
          '1066': 231,
          '1067': 110,
          '1068': 41,
          '1069': 5,
          '1070': 50,
          '1071': 40,
          '1072': 136,
          '1073': 202,
          '1074': 44,
          '1075': 131,
          '1076': 211,
          '1077': 185,
          '1078': 211,
          '1079': 74,
          '1080': 73,
          '1081': 160,
          '1082': 131,
          '1083': 114,
          '1084': 168,
          '1085': 9,
          '1086': 179,
          '1087': 14,
          '1088': 78,
          '1089': 231,
          '1090': 78,
          '1091': 45,
          '1092': 37,
          '1093': 129,
          '1094': 16,
          '1095': 10,
          '1096': 162,
          '1097': 50,
          '1098': 11,
          '1099': 225,
          '1100': 100,
          '1101': 252,
          '1102': 114,
          '1103': 218,
          '1104': 66,
          '1105': 251,
          '1106': 191,
          '1107': 92,
          '1108': 149,
          '1109': 244,
          '1110': 193,
          '1111': 230,
          '1112': 223,
          '1113': 168,
          '1114': 7,
          '1115': 125,
          '1116': 112,
          '1117': 50,
          '1118': 234,
          '1119': 131,
          '1120': 117,
          '1121': 24,
          '1122': 232,
          '1123': 96,
          '1124': 38,
          '1125': 55,
          '1126': 159,
          '1127': 220,
          '1128': 191,
          '1129': 188,
          '1130': 134,
          '1131': 123,
          '1132': 50,
          '1133': 73,
          '1134': 96,
          '1135': 131,
          '1136': 130,
          '1137': 160,
          '1138': 220,
          '1139': 23,
          '1140': 63,
          '1141': 188,
          '1142': 31,
          '1143': 195,
          '1144': 54,
          '1145': 10,
          '1146': 108,
          '1147': 80,
          '1148': 144,
          '1149': 148,
          '1150': 217,
          '1151': 6,
          '1152': 251,
          '1153': 163,
          '1154': 15,
          '1155': 224,
          '1156': 240,
          '1157': 125,
          '1158': 18,
          '1159': 216,
          '1160': 160,
          '1161': 32,
          '1162': 41,
          '1163': 179,
          '1164': 13,
          '1165': 26,
          '1166': 82,
          '1167': 112,
          '1168': 244,
          '1169': 62,
          '1170': 9,
          '1171': 108,
          '1172': 80,
          '1173': 144,
          '1174': 148,
          '1175': 217,
          '1176': 6,
          '1177': 13,
          '1178': 105,
          '1179': 2,
          '1180': 70,
          '1181': 15,
          '1182': 100,
          '1183': 80,
          '1184': 144,
          '1185': 148,
          '1186': 89,
          '1187': 6,
          '1188': 13,
          '1189': 41,
          '1190': 56,
          '1191': 77,
          '1192': 145,
          '1193': 4,
          '1194': 46,
          '1195': 40,
          '1196': 72,
          '1197': 202,
          '1198': 236,
          '1199': 130,
          '1200': 239,
          '1201': 230,
          '1202': 61,
          '1203': 239,
          '1204': 3,
          '1205': 28,
          '1206': 216,
          '1207': 160,
          '1208': 32,
          '1209': 44,
          '1210': 179,
          '1211': 13,
          '1212': 190,
          '1213': 157,
          '1214': 140,
          '1215': 246,
          '1216': 95,
          '1217': 214,
          '1218': 94,
          '1219': 37,
          '1220': 73,
          '1221': 122,
          '1222': 67,
          '1223': 243,
          '1224': 70,
          '1225': 58,
          '1226': 232,
          '1227': 13,
          '1228': 6,
          '1229': 19,
          '1230': 236,
          '1231': 201,
          '1232': 164,
          '1233': 129,
          '1234': 243,
          '1235': 230,
          '1236': 98,
          '1237': 19,
          '1238': 154,
          '1239': 50,
          '1240': 59,
          '1241': 239,
          '1242': 98,
          '1243': 253,
          '1244': 191,
          '1245': 114,
          '1246': 211,
          '1247': 217,
          '1248': 175,
          '1249': 200,
          '1250': 162,
          '1251': 61,
          '1252': 115,
          '1253': 218,
          '1254': 188,
          '1255': 123,
          '1256': 15,
          '1257': 255,
          '1258': 128,
          '1259': 126,
          '1260': 49,
          '1261': 254,
          '1262': 12,
          '1263': 214,
          '1264': 99,
          '1265': 32,
          '1266': 247,
          '1267': 133,
          '1268': 220,
          '1269': 156,
          '1270': 114,
          '1271': 203,
          '1272': 253,
          '1273': 172,
          '1274': 15,
          '1275': 73,
          '1276': 3,
          '1277': 237,
          '1278': 21,
          '1279': 36,
          '1280': 229,
          '1281': 214,
          '1282': 222,
          '1283': 139,
          '1284': 5,
          '1285': 36,
          '1286': 13,
          '1287': 188,
          '1288': 87,
          '1289': 144,
          '1290': 148,
          '1291': 217,
          '1292': 123,
          '1293': 171,
          '1294': 237,
          '1295': 52,
          '1296': 222,
          '1297': 111,
          '1298': 28,
          '1299': 237,
          '1300': 185,
          '1301': 97,
          '1302': 22,
          '1303': 225,
          '1304': 78,
          '1305': 45,
          '1306': 223,
          '1307': 178,
          '1308': 157,
          '1309': 6,
          '1310': 134,
          '1311': 47,
          '1312': 118,
          '1313': 247,
          '1314': 146,
          '1315': 122,
          '1316': 89,
          '1317': 142,
          '1318': 182,
          '1319': 157,
          '1320': 6,
          '1321': 134,
          '1322': 47,
          '1323': 72,
          '1324': 202,
          '1325': 125,
          '1326': 218,
          '1327': 223,
          '1328': 221,
          '1329': 78,
          '1330': 3,
          '1331': 195,
          '1332': 23,
          '1333': 36,
          '1334': 229,
          '1335': 254,
          '1336': 21,
          '1337': 216,
          '1338': 234,
          '1339': 205,
          '1340': 124,
          '1341': 2,
          '1342': 190,
          '1343': 79,
          '1344': 219,
          '1345': 115,
          '1346': 67,
          '1347': 26,
          '1348': 194,
          '1349': 109,
          '1350': 134,
          '1351': 14,
          '1352': 95,
          '1353': 38,
          '1354': 57,
          '1355': 155,
          '1356': 193,
          '1357': 57,
          '1358': 13,
          '1359': 246,
          '1360': 101,
          '1361': 196,
          '1362': 174,
          '1363': 87,
          '1364': 175,
          '1365': 151,
          '1366': 133,
          '1367': 113,
          '1368': 95,
          '1369': 230,
          '1370': 210,
          '1371': 33,
          '1372': 13,
          '1373': 246,
          '1374': 101,
          '1375': 4,
          '1376': 73,
          '1377': 185,
          '1378': 111,
          '1379': 29,
          '1380': 53,
          '1381': 233,
          '1382': 57,
          '1383': 168,
          '1384': 193,
          '1385': 158,
          '1386': 140,
          '1387': 32,
          '1388': 42,
          '1389': 243,
          '1390': 158,
          '1391': 204,
          '1392': 204,
          '1393': 33,
          '1394': 205,
          '1395': 2,
          '1396': 197,
          '1397': 151,
          '1398': 35,
          '1399': 205,
          '1400': 152,
          '1401': 21,
          '1402': 255,
          '1403': 210,
          '1404': 37,
          '1405': 13,
          '1406': 196,
          '1407': 87,
          '1408': 144,
          '1409': 148,
          '1410': 89,
          '1411': 124,
          '1412': 231,
          '1413': 179,
          '1414': 161,
          '1415': 131,
          '1416': 26,
          '1417': 152,
          '1418': 175,
          '1419': 32,
          '1420': 42,
          '1421': 247,
          '1422': 239,
          '1423': 221,
          '1424': 220,
          '1425': 73,
          '1426': 13,
          '1427': 204,
          '1428': 87,
          '1429': 144,
          '1430': 148,
          '1431': 217,
          '1432': 124,
          '1433': 103,
          '1434': 189,
          '1435': 129,
          '1436': 131,
          '1437': 26,
          '1438': 8,
          '1439': 161,
          '1440': 32,
          '1441': 42,
          '1442': 179,
          '1443': 16,
          '1444': 94,
          '1445': 122,
          '1446': 168,
          '1447': 129,
          '1448': 17,
          '1449': 10,
          '1450': 162,
          '1451': 50,
          '1452': 27,
          '1453': 161,
          '1454': 251,
          '1455': 69,
          '1456': 147,
          '1457': 5,
          '1458': 70,
          '1459': 40,
          '1460': 72,
          '1461': 122,
          '1462': 12,
          '1463': 35,
          '1464': 4,
          '1465': 123,
          '1466': 110,
          '1467': 237,
          '1468': 249,
          '1469': 137,
          '1470': 27,
          '1471': 225,
          '1472': 110,
          '1473': 140,
          '1474': 223,
          '1475': 96,
          '1476': 132,
          '1477': 89,
          '1478': 96,
          '1479': 132,
          '1480': 98,
          '1481': 63,
          '1482': 134,
          '1483': 170,
          '1484': 151,
          '1485': 229,
          '1486': 88,
          '1487': 70,
          '1488': 152,
          '1489': 5,
          '1490': 70,
          '1491': 40,
          '1492': 72,
          '1493': 122,
          '1494': 92,
          '1495': 35,
          '1496': 204,
          '1497': 2,
          '1498': 35,
          '1499': 20,
          '1500': 68,
          '1501': 61,
          '1502': 170,
          '1503': 17,
          '1504': 230,
          '1505': 129,
          '1506': 17,
          '1507': 202,
          '1508': 145,
          '1509': 230,
          '1510': 71,
          '1511': 53,
          '1512': 194,
          '1513': 60,
          '1514': 48,
          '1515': 66,
          '1516': 65,
          '1517': 210,
          '1518': 227,
          '1519': 26,
          '1520': 97,
          '1521': 30,
          '1522': 24,
          '1523': 161,
          '1524': 32,
          '1525': 234,
          '1526': 81,
          '1527': 141,
          '1528': 48,
          '1529': 15,
          '1530': 140,
          '1531': 80,
          '1532': 144,
          '1533': 244,
          '1534': 184,
          '1535': 70,
          '1536': 152,
          '1537': 7,
          '1538': 70,
          '1539': 40,
          '1540': 136,
          '1541': 122,
          '1542': 92,
          '1543': 35,
          '1544': 204,
          '1545': 3,
          '1546': 35,
          '1547': 20,
          '1548': 68,
          '1549': 61,
          '1550': 170,
          '1551': 17,
          '1552': 230,
          '1553': 129,
          '1554': 17,
          '1555': 10,
          '1556': 146,
          '1557': 50,
          '1558': 27,
          '1559': 225,
          '1560': 112,
          '1561': 50,
          '1562': 122,
          '1563': 247,
          '1564': 34,
          '1565': 97,
          '1566': 254,
          '1567': 157,
          '1568': 156,
          '1569': 5,
          '1570': 125,
          '1571': 144,
          '1572': 112,
          '1573': 35,
          '1574': 231,
          '1575': 195,
          '1576': 143,
          '1577': 190,
          '1578': 152,
          '1579': 12,
          '1580': 46,
          '1581': 192,
          '1582': 90,
          '1583': 244,
          '1584': 125,
          '1585': 176,
          '1586': 43,
          '1587': 247,
          '1588': 51,
          '1589': 106,
          '1590': 194,
          '1591': 67,
          '1592': 62,
          '1593': 94,
          '1594': 153,
          '1595': 209,
          '1596': 254,
          '1597': 8,
          '1598': 92,
          '1599': 128,
          '1600': 229,
          '1601': 223,
          '1602': 134,
          '1603': 92,
          '1604': 20,
          '1605': 149,
          '1606': 89,
          '1607': 8,
          '1608': 135,
          '1609': 147,
          '1610': 15,
          '1611': 103,
          '1612': 99,
          '1613': 48,
          '1614': 188,
          '1615': 47,
          '1616': 132,
          '1617': 146,
          '1618': 168,
          '1619': 204,
          '1620': 66,
          '1621': 104,
          '1622': 102,
          '1623': 117,
          '1624': 127,
          '1625': 203,
          '1626': 142,
          '1627': 216,
          '1628': 191,
          '1629': 227,
          '1630': 129,
          '1631': 36,
          '1632': 41,
          '1633': 225,
          '1634': 150,
          '1635': 7,
          '1636': 175,
          '1637': 144,
          '1638': 190,
          '1639': 61,
          '1640': 7,
          '1641': 163,
          '1642': 251,
          '1643': 66,
          '1644': 40,
          '1645': 73,
          '1646': 202,
          '1647': 44,
          '1648': 132,
          '1649': 102,
          '1650': 78,
          '1651': 193,
          '1652': 167,
          '1653': 55,
          '1654': 120,
          '1655': 24,
          '1656': 143,
          '1657': 36,
          '1658': 41,
          '1659': 179,
          '1660': 15,
          '1661': 14,
          '1662': 39,
          '1663': 99,
          '1664': 56,
          '1665': 167,
          '1666': 190,
          '1667': 15,
          '1668': 74,
          '1669': 146,
          '1670': 50,
          '1671': 251,
          '1672': 224,
          '1673': 112,
          '1674': 50,
          '1675': 4,
          '1676': 87,
          '1677': 235,
          '1678': 4,
          '1679': 15,
          '1680': 226,
          '1681': 145,
          '1682': 36,
          '1683': 101,
          '1684': 214,
          '1685': 193,
          '1686': 225,
          '1687': 4,
          '1688': 222,
          '1689': 111,
          '1690': 38,
          '1691': 14,
          '1692': 158,
          '1693': 195,
          '1694': 35,
          '1695': 137,
          '1696': 202,
          '1697': 172,
          '1698': 131,
          '1699': 95,
          '1700': 254,
          '1701': 251,
          '1702': 199,
          '1703': 106,
          '1704': 149,
          '1705': 236,
          '1706': 143,
          '1707': 155,
          '1708': 85,
          '1709': 79,
          '1710': 94,
          '1711': 216,
          '1712': 163,
          '1713': 237,
          '1714': 132,
          '1715': 166,
          '1716': 153,
          '1717': 22,
          '1718': 65,
          '1719': 107,
          '1720': 121,
          '1721': 205,
          '1722': 188,
          '1723': 190,
          '1724': 71,
          '1725': 154,
          '1726': 190,
          '1727': 171,
          '1728': 160,
          '1729': 14,
          '1730': 145,
          '1731': 174,
          '1732': 86,
          '1733': 96,
          '1734': 45,
          '1735': 22,
          '1736': 28,
          '1737': 148,
          '1738': 137,
          '1739': 187,
          '1740': 122,
          '1741': 189,
          '1742': 207,
          '1743': 72,
          '1744': 28,
          '1745': 161,
          '1746': 211,
          '1747': 123,
          '1748': 152,
          '1749': 179,
          '1750': 94,
          '1751': 180,
          '1752': 111,
          '1753': 7,
          '1754': 253,
          '1755': 197,
          '1756': 132,
          '1757': 92,
          '1758': 93,
          '1759': 215,
          '1760': 79,
          '1761': 189,
          '1762': 123,
          '1763': 121,
          '1764': 18,
          '1765': 221,
          '1766': 218,
          '1767': 174,
          '1768': 232,
          '1769': 31,
          '1770': 127,
          '1771': 178,
          '1772': 79,
          '1773': 161,
          '1774': 121,
          '1775': 188,
          '1776': 255,
          '1777': 180,
          '1778': 89,
          '1779': 149,
          '1780': 207,
          '1781': 235,
          '1782': 222,
          '1783': 62,
          '1784': 140,
          '1785': 46,
          '1786': 122,
          '1787': 126,
          '1788': 68,
          '1789': 77,
          '1790': 189,
          '1791': 60,
          '1792': 230,
          '1793': 163,
          '1794': 246,
          '1795': 96,
          '1796': 94,
          '1797': 249,
          '1798': 107,
          '1799': 109,
          '1800': 55,
          '1801': 248,
          '1802': 15,
          '1803': 246,
          '1804': 197,
          '1805': 211,
          '1806': 110,
          '1807': 173,
          '1808': 190,
          '1809': 204,
          '1810': 175,
          '1811': 157,
          '1812': 150,
          '1813': 188,
          '1814': 251,
          '1815': 227,
          '1816': 79,
          '1817': 245,
          '1818': 3,
          '1819': 206,
          '1820': 94,
          '1821': 66,
          '1822': 234,
          '1823': 97,
          '1824': 159,
          '1825': 83,
          '1826': 234,
          '1827': 183,
          '1828': 57,
          '1829': 98,
          '1830': 82,
          '1831': 60,
          '1832': 38,
          '1833': 101,
          '1834': 138,
          '1835': 201,
          '1836': 240,
          '1837': 152,
          '1838': 140,
          '1839': 41,
          '1840': 38,
          '1841': 199,
          '1842': 99,
          '1843': 114,
          '1844': 166,
          '1845': 152,
          '1846': 2,
          '1847': 143,
          '1848': 41,
          '1849': 152,
          '1850': 98,
          '1851': 186,
          '1852': 120,
          '1853': 12,
          '1854': 215,
          '1855': 39,
          '1856': 77,
          '1857': 225,
          '1858': 49,
          '1859': 138,
          '1860': 41,
          '1861': 70,
          '1862': 227,
          '1863': 49,
          '1864': 186,
          '1865': 97,
          '1866': 140,
          '1867': 187,
          '1868': 105,
          '1869': 58,
          '1870': 44,
          '1871': 254,
          '1872': 166,
          '1873': 73,
          '1874': 39,
          '1875': 81,
          '1876': 59,
          '1877': 146,
          '1878': 234,
          '1879': 171,
          '1880': 10,
          '1881': 144,
          '1882': 40,
          '1883': 151,
          '1884': 164,
          '1885': 122,
          '1886': 155,
          '1887': 35,
          '1888': 38,
          '1889': 198,
          '1890': 99,
          '1891': 98,
          '1892': 166,
          '1893': 152,
          '1894': 4,
          '1895': 143,
          '1896': 161,
          '1897': 23,
          '1898': 141,
          '1899': 141,
          '1900': 73,
          '1901': 241,
          '1902': 24,
          '1903': 122,
          '1904': 209,
          '1905': 216,
          '1906': 152,
          '1907': 12,
          '1908': 143,
          '1909': 161,
          '1910': 23,
          '1911': 141,
          '1912': 141,
          '1913': 201,
          '1914': 241,
          '1915': 24,
          '1916': 122,
          '1917': 209,
          '1918': 216,
          '1919': 152,
          '1920': 2,
          '1921': 143,
          '1922': 161,
          '1923': 23,
          '1924': 141,
          '1925': 141,
          '1926': 233,
          '1927': 226,
          '1928': 49,
          '1929': 244,
          '1930': 162,
          '1931': 177,
          '1932': 49,
          '1933': 10,
          '1934': 143,
          '1935': 225,
          '1936': 218,
          '1937': 60,
          '1938': 53,
          '1939': 30,
          '1940': 211,
          '1941': 180,
          '1942': 104,
          '1943': 188,
          '1944': 24,
          '1945': 133,
          '1946': 183,
          '1947': 128,
          '1948': 98,
          '1949': 106,
          '1950': 1,
          '1951': 133,
          '1952': 183,
          '1953': 128,
          '1954': 98,
          '1955': 106,
          '1956': 1,
          '1957': 133,
          '1958': 183,
          '1959': 128,
          '1960': 98,
          '1961': 106,
          '1962': 1,
          '1963': 133,
          '1964': 183,
          '1965': 128,
          '1966': 98,
          '1967': 106,
          '1968': 1,
          '1969': 133,
          '1970': 183,
          '1971': 128,
          '1972': 98,
          '1973': 106,
          '1974': 1,
          '1975': 133,
          '1976': 183,
          '1977': 128,
          '1978': 98,
          '1979': 106,
          '1980': 1,
          '1981': 133,
          '1982': 183,
          '1983': 128,
          '1984': 98,
          '1985': 106,
          '1986': 1,
          '1987': 133,
          '1988': 183,
          '1989': 128,
          '1990': 98,
          '1991': 106,
          '1992': 1,
          '1993': 133,
          '1994': 183,
          '1995': 128,
          '1996': 98,
          '1997': 106,
          '1998': 1,
          '1999': 133,
          '2000': 183,
          '2001': 128,
          '2002': 98,
          '2003': 106,
          '2004': 1,
          '2005': 141,
          '2006': 183,
          '2007': 128,
          '2008': 102,
          '2009': 106,
          '2010': 1,
          '2011': 141,
          '2012': 183,
          '2013': 128,
          '2014': 102,
          '2015': 106,
          '2016': 1,
          '2017': 141,
          '2018': 183,
          '2019': 128,
          '2020': 102,
          '2021': 106,
          '2022': 1,
          '2023': 141,
          '2024': 183,
          '2025': 128,
          '2026': 102,
          '2027': 106,
          '2028': 1,
          '2029': 141,
          '2030': 183,
          '2031': 128,
          '2032': 102,
          '2033': 106,
          '2034': 1,
          '2035': 141,
          '2036': 183,
          '2037': 128,
          '2038': 102,
          '2039': 106,
          '2040': 1,
          '2041': 141,
          '2042': 183,
          '2043': 128,
          '2044': 110,
          '2045': 218,
          '2046': 2,
          '2047': 174,
          '2048': 63,
          '2049': 59,
          '2050': 91,
          '2051': 141,
          '2052': 239,
          '2053': 207,
          '2054': 244,
          '2055': 109,
          '2056': 70,
          '2057': 87,
          '2058': 36,
          '2059': 94,
          '2060': 209,
          '2061': 104,
          '2062': 143,
          '2063': 132,
          '2064': 94,
          '2065': 52,
          '2066': 54,
          '2067': 70,
          '2068': 225,
          '2069': 49,
          '2070': 244,
          '2071': 162,
          '2072': 177,
          '2073': 49,
          '2074': 26,
          '2075': 143,
          '2076': 97,
          '2077': 217,
          '2078': 175,
          '2079': 41,
          '2080': 58,
          '2081': 200,
          '2082': 188,
          '2083': 20,
          '2084': 228,
          '2085': 146,
          '2086': 41,
          '2087': 76,
          '2088': 70,
          '2089': 125,
          '2090': 135,
          '2091': 222,
          '2092': 61,
          '2093': 73,
          '2094': 225,
          '2095': 164,
          '2096': 212,
          '2097': 111,
          '2098': 211,
          '2099': 73,
          '2100': 98,
          '2101': 140,
          '2102': 164,
          '2103': 105,
          '2104': 143,
          '2105': 185,
          '2106': 17,
          '2107': 9,
          '2108': 22,
          '2109': 65,
          '2110': 238,
          '2111': 176,
          '2112': 34,
          '2113': 169,
          '2114': 86,
          '2115': 150,
          '2116': 219,
          '2117': 200,
          '2118': 118,
          '2119': 88,
          '2120': 176,
          '2121': 178,
          '2122': 200,
          '2123': 141,
          '2124': 92,
          '2125': 199,
          '2126': 36,
          '2127': 120,
          '2128': 12,
          '2129': 23,
          '2130': 77,
          '2131': 138,
          '2132': 199,
          '2133': 144,
          '2134': 27,
          '2135': 185,
          '2136': 142,
          '2137': 201,
          '2138': 240,
          '2139': 24,
          '2140': 114,
          '2141': 35,
          '2142': 215,
          '2143': 49,
          '2144': 57,
          '2145': 30,
          '2146': 67,
          '2147': 110,
          '2148': 228,
          '2149': 58,
          '2150': 166,
          '2151': 192,
          '2152': 99,
          '2153': 200,
          '2154': 94,
          '2155': 86,
          '2156': 199,
          '2157': 116,
          '2158': 241,
          '2159': 24,
          '2160': 114,
          '2161': 93,
          '2162': 214,
          '2163': 49,
          '2164': 10,
          '2165': 143,
          '2166': 33,
          '2167': 215,
          '2168': 101,
          '2169': 29,
          '2170': 163,
          '2171': 241,
          '2172': 24,
          '2173': 242,
          '2174': 119,
          '2175': 140,
          '2176': 141,
          '2177': 137,
          '2178': 59,
          '2179': 104,
          '2180': 76,
          '2181': 76,
          '2182': 175,
          '2183': 76,
          '2184': 27,
          '2185': 131,
          '2186': 183,
          '2187': 64,
          '2188': 204,
          '2189': 211,
          '2190': 103,
          '2191': 206,
          '2192': 198,
          '2193': 233,
          '2194': 247,
          '2195': 25,
          '2196': 125,
          '2197': 211,
          '2198': 76,
          '2199': 43,
          '2200': 18,
          '2201': 175,
          '2202': 104,
          '2203': 82,
          '2204': 143,
          '2205': 132,
          '2206': 94,
          '2207': 52,
          '2208': 54,
          '2209': 38,
          '2210': 197,
          '2211': 99,
          '2212': 184,
          '2213': 104,
          '2214': 50,
          '2215': 60,
          '2216': 134,
          '2217': 94,
          '2218': 52,
          '2219': 54,
          '2220': 38,
          '2221': 199,
          '2222': 99,
          '2223': 232,
          '2224': 69,
          '2225': 99,
          '2226': 99,
          '2227': 10,
          '2228': 60,
          '2229': 134,
          '2230': 94,
          '2231': 52,
          '2232': 54,
          '2233': 166,
          '2234': 139,
          '2235': 199,
          '2236': 208,
          '2237': 139,
          '2238': 198,
          '2239': 198,
          '2240': 40,
          '2241': 60,
          '2242': 134,
          '2243': 94,
          '2244': 52,
          '2245': 54,
          '2246': 70,
          '2247': 227,
          '2248': 49,
          '2249': 244,
          '2250': 162,
          '2251': 169,
          '2252': 98,
          '2253': 146,
          '2254': 14,
          '2255': 26,
          '2256': 147,
          '2257': 208,
          '2258': 139,
          '2259': 198,
          '2260': 198,
          '2261': 196,
          '2262': 120,
          '2263': 12,
          '2264': 79,
          '2265': 209,
          '2266': 56,
          '2267': 91,
          '2268': 141,
          '2269': 95,
          '2270': 52,
          '2271': 244,
          '2272': 109,
          '2273': 38,
          '2274': 171,
          '2275': 72,
          '2276': 188,
          '2277': 162,
          '2278': 201,
          '2279': 60,
          '2280': 18,
          '2281': 122,
          '2282': 209,
          '2283': 216,
          '2284': 152,
          '2285': 20,
          '2286': 143,
          '2287': 161,
          '2288': 23,
          '2289': 141,
          '2290': 141,
          '2291': 201,
          '2292': 240,
          '2293': 24,
          '2294': 174,
          '2295': 149,
          '2296': 150,
          '2297': 227,
          '2298': 49,
          '2299': 244,
          '2300': 162,
          '2301': 177,
          '2302': 49,
          '2303': 5,
          '2304': 30,
          '2305': 67,
          '2306': 47,
          '2307': 26,
          '2308': 27,
          '2309': 211,
          '2310': 197,
          '2311': 99,
          '2312': 232,
          '2313': 69,
          '2314': 99,
          '2315': 99,
          '2316': 20,
          '2317': 30,
          '2318': 67,
          '2319': 47,
          '2320': 26,
          '2321': 27,
          '2322': 163,
          '2323': 241,
          '2324': 24,
          '2325': 158,
          '2326': 29,
          '2327': 64,
          '2328': 231,
          '2329': 3,
          '2330': 224,
          '2331': 111,
          '2332': 154,
          '2333': 244,
          '2334': 233,
          '2335': 207,
          '2336': 119,
          '2337': 36,
          '2338': 169,
          '2339': 215,
          '2340': 101,
          '2341': 185,
          '2342': 75,
          '2343': 146,
          '2344': 242,
          '2345': 236,
          '2346': 0,
          '2347': 22,
          '2348': 24,
          '2349': 9,
          '2350': 253,
          '2351': 19,
          '2352': 86,
          '2353': 84,
          '2354': 36,
          '2355': 94,
          '2356': 93,
          '2357': 22,
          '2358': 30,
          '2359': 9,
          '2360': 125,
          '2361': 239,
          '2362': 204,
          '2363': 198,
          '2364': 36,
          '2365': 120,
          '2366': 12,
          '2367': 189,
          '2368': 203,
          '2369': 108,
          '2370': 76,
          '2371': 138,
          '2372': 199,
          '2373': 52,
          '2374': 237,
          '2375': 50,
          '2376': 119,
          '2377': 94,
          '2378': 176,
          '2379': 171,
          '2380': 26,
          '2381': 232,
          '2382': 231,
          '2383': 154,
          '2384': 139,
          '2385': 110,
          '2386': 69,
          '2387': 226,
          '2388': 213,
          '2389': 101,
          '2390': 215,
          '2391': 35,
          '2392': 161,
          '2393': 215,
          '2394': 165,
          '2395': 141,
          '2396': 201,
          '2397': 241,
          '2398': 24,
          '2399': 250,
          '2400': 246,
          '2401': 98,
          '2402': 99,
          '2403': 10,
          '2404': 60,
          '2405': 134,
          '2406': 229,
          '2407': 144,
          '2408': 156,
          '2409': 123,
          '2410': 122,
          '2411': 222,
          '2412': 159,
          '2413': 23,
          '2414': 122,
          '2415': 135,
          '2416': 169,
          '2417': 138,
          '2418': 196,
          '2419': 107,
          '2420': 100,
          '2421': 229,
          '2422': 145,
          '2423': 208,
          '2424': 167,
          '2425': 223,
          '2426': 198,
          '2427': 40,
          '2428': 60,
          '2429': 134,
          '2430': 139,
          '2431': 70,
          '2432': 227,
          '2433': 49,
          '2434': 116,
          '2435': 245,
          '2436': 171,
          '2437': 98,
          '2438': 178,
          '2439': 14,
          '2440': 26,
          '2441': 147,
          '2442': 209,
          '2443': 213,
          '2444': 207,
          '2445': 198,
          '2446': 196,
          '2447': 120,
          '2448': 12,
          '2449': 189,
          '2450': 203,
          '2451': 108,
          '2452': 76,
          '2453': 130,
          '2454': 199,
          '2455': 208,
          '2456': 187,
          '2457': 204,
          '2458': 198,
          '2459': 164,
          '2460': 120,
          '2461': 12,
          '2462': 221,
          '2463': 203,
          '2464': 108,
          '2465': 76,
          '2466': 134,
          '2467': 199,
          '2468': 208,
          '2469': 139,
          '2470': 198,
          '2471': 198,
          '2472': 228,
          '2473': 120,
          '2474': 12,
          '2475': 189,
          '2476': 104,
          '2477': 108,
          '2478': 76,
          '2479': 129,
          '2480': 199,
          '2481': 240,
          '2482': 20,
          '2483': 13,
          '2484': 118,
          '2485': 236,
          '2486': 191,
          '2487': 241,
          '2488': 229,
          '2489': 57,
          '2490': 123,
          '2491': 18,
          '2492': 93,
          '2493': 145,
          '2494': 120,
          '2495': 69,
          '2496': 163,
          '2497': 61,
          '2498': 18,
          '2499': 122,
          '2500': 209,
          '2501': 216,
          '2502': 24,
          '2503': 133,
          '2504': 199,
          '2505': 208,
          '2506': 139,
          '2507': 198,
          '2508': 198,
          '2509': 104,
          '2510': 60,
          '2511': 134,
          '2512': 105,
          '2513': 165,
          '2514': 229,
          '2515': 29,
          '2516': 52,
          '2517': 38,
          '2518': 167,
          '2519': 23,
          '2520': 141,
          '2521': 141,
          '2522': 137,
          '2523': 241,
          '2524': 24,
          '2525': 122,
          '2526': 209,
          '2527': 216,
          '2528': 152,
          '2529': 4,
          '2530': 143,
          '2531': 161,
          '2532': 23,
          '2533': 141,
          '2534': 141,
          '2535': 73,
          '2536': 241,
          '2537': 24,
          '2538': 122,
          '2539': 209,
          '2540': 216,
          '2541': 152,
          '2542': 12,
          '2543': 143,
          '2544': 161,
          '2545': 23,
          '2546': 141,
          '2547': 141,
          '2548': 201,
          '2549': 241,
          '2550': 24,
          '2551': 122,
          '2552': 209,
          '2553': 216,
          '2554': 152,
          '2555': 2,
          '2556': 143,
          '2557': 97,
          '2558': 41,
          '2559': 26,
          '2560': 247,
          '2561': 250,
          '2562': 57,
          '2563': 175,
          '2564': 104,
          '2565': 232,
          '2566': 87,
          '2567': 207,
          '2568': 117,
          '2569': 171,
          '2570': 147,
          '2571': 89,
          '2572': 238,
          '2573': 69,
          '2574': 186,
          '2575': 245,
          '2576': 176,
          '2577': 128,
          '2578': 132,
          '2579': 92,
          '2580': 52,
          '2581': 117,
          '2582': 140,
          '2583': 194,
          '2584': 99,
          '2585': 200,
          '2586': 69,
          '2587': 83,
          '2588': 199,
          '2589': 104,
          '2590': 60,
          '2591': 134,
          '2592': 92,
          '2593': 52,
          '2594': 54,
          '2595': 198,
          '2596': 61,
          '2597': 205,
          '2598': 24,
          '2599': 196,
          '2600': 208,
          '2601': 79,
          '2602': 52,
          '2603': 214,
          '2604': 49,
          '2605': 49,
          '2606': 30,
          '2607': 67,
          '2608': 46,
          '2609': 154,
          '2610': 58,
          '2611': 38,
          '2612': 193,
          '2613': 99,
          '2614': 200,
          '2615': 69,
          '2616': 83,
          '2617': 199,
          '2618': 164,
          '2619': 120,
          '2620': 12,
          '2621': 185,
          '2622': 104,
          '2623': 234,
          '2624': 152,
          '2625': 12,
          '2626': 143,
          '2627': 33,
          '2628': 23,
          '2629': 77,
          '2630': 29,
          '2631': 147,
          '2632': 227,
          '2633': 49,
          '2634': 223,
          '2635': 95,
          '2636': 52,
          '2637': 96,
          '2638': 195,
          '2639': 255,
          '2640': 231,
          '2641': 137,
          '2642': 141,
          '2643': 147,
          '2644': 232,
          '2645': 9,
          '2646': 41,
          '2647': 135,
          '2648': 56,
          '2649': 122,
          '2650': 25,
          '2651': 209,
          '2652': 188,
          '2653': 168,
          '2654': 150,
          '2655': 247,
          '2656': 159,
          '2657': 43,
          '2658': 201,
          '2659': 27,
          '2660': 179,
          '2661': 94,
          '2662': 12,
          '2663': 192,
          '2664': 84,
          '2665': 68,
          '2666': 79,
          '2667': 191,
          '2668': 60,
          '2669': 253,
          '2670': 31,
          '2671': 89,
          '2672': 58,
          '2673': 49,
          '2674': 213
        },
        { to: 'string' }
      )

      const ls = JSON.parse(data)
      console.log(ls)
      const result = JSON.parse(decompressed)
      const nodesArray = result.nodes
      const edgesArray = result.edges
      if (nodesArray) {
        set({
          nodes: [...nodesArray],
          edges: edgesArray
        })
      }
    } catch (error) {
      throwErrorMessage(error)
    }
  },

  createPeripheral: async (params, fn, id, cancel, tabs, fn2) => {
    const { addChildNode } = get()
    try {
      const res = await newSetPeripheral(params)
      if (res.code !== 0) return
      if (res.data) {
        fn(id, tabs)
        cancel()
        addChildNode(res.data, res.data.platform_id)
      }
      fn2(AttributesType[res.data.flag as keyof typeof AttributesType], res.data.id)
    } catch (error) {
      throwErrorMessage(error)
    }
  },

  createRegister: async (params, fn, id, cancel, tabs, fn2) => {
    const { addChildNode } = get()
    try {
      const res = await newSetRegister(params)
      if (res.data) {
        fn(id, tabs)
        cancel()
        addChildNode(res.data, res.data.peripheral_id)
        fn2(AttributesType[res.data.flag as keyof typeof AttributesType], res.data.id)
      }
    } catch (error) {
      throwErrorMessage(error)
    }
  },

  createDataHandler: async (params, fn, id, cancel, tabs, fn2) => {
    try {
      const res = await newSetDataHander(params)
      if (res.data) {
        fn(id, tabs)
        cancel()
      }
    } catch (error) {
      throwErrorMessage(error)
    }
  },

  createTimer: async (params, fn, id, cancel, tabs, fn2) => {
    try {
      const res = await newSetTimer(params)
      if (res.data) {
        fn(id, tabs)
        cancel()
      }
    } catch (error) {
      throwErrorMessage(error)
    }
  },

  createElement: (tabs, params, fn, id, cancel, fn2) => {
    const { createPeripheral, createRegister, createDataHandler, createTimer } = get()
    const componentFunctions = {
      customMadePeripheral: createPeripheral,
      processor: createRegister,
      dataHandlerNotReferenced: createDataHandler,
      time: createTimer
    }
    componentFunctions[tabs as keyof typeof componentFunctions](params, fn, id, cancel, tabs, fn2)
  },

  clearNodeAndEdge: () => {
    set({ nodes: [], edges: [] })
  },
  // 更新画布中节点的名称
  updateNodeName: (id: string, typeAndValue) => {
    set({
      nodes: get().nodes.map((node: Node) => {
        if (node.id === id) {
          // it's important to create a new object here, to inform React Flow about the changes
          return { ...node, data: { ...node.data, ...typeAndValue } }
        }
        return node
      })
    })
  },

  // 保存画布并且更新数据
  saveCanvasAndUpdateNodeName: (id: string, typeAndValue) => {
    const { saveCanvas, updateNodeName } = get()
    updateNodeName(id, typeAndValue)

    saveCanvas(get().nodes, get().edges, id)
  }
}))

export default MiddleStore
